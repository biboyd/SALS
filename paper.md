---
title: 'SALSA: A Python Package for Constructing Synthetic Quasar Absorption Line Catalogs from Astrophysical Hydrodynamic Simulations'
tags:
  - Python
  - astronomy
  - simulation
  - spectra
authors:
  - name: Brendan Boyd
    orcid: 0000-0003-0872-7098
    affiliation: 1
  - name: Devin W. Silvia
    affiliation: 2
  - name: Brian W. O'Shea
    affiliation: "1, 2, 3"
  - name: Jason Tumlinson
    affiliation: "4, 5"
  - name: Molly Peeples
    affiliation: "4, 5"
  - name: Nicholas Earl
    affiliation: 4
affiliations:
 - name: Department of Physics and Astronomy, Michigan State University
   index: 1
 - name: Department of Computational Mathematics, Science and Engineering, Michigan State University
   index: 2
 - name: National Superconducting Cyclotron Laboratory, Michigan State University
   index: 3
 - name: Space Telescope Science Institute
   index: 4
 - name: Department of Physics & Astronomy, Johns Hopkins University
   index: 5
date: 9 July 2020
bibliography: paper.bib
---

# Summary

The hot, low density gas surrounding galaxies, called the circumgalactic medium
(CGM), is vital to understanding the structure and evolution of galaxies
[@Tumlinson:2017; @Voit:2017]. The diffuse nature of the CGM makes it difficult
to observe by direction detection in emission, so much of our understanding
comes from studying absorption line features in the spectra of light from
distant quasars that pass through intervening galaxies
[@Howk:2017; @Lehner:2018]. A single quasar sightline only contains information 
about a relatively small portion of gas in the halo of an individual galaxy.
Because of this,  observational astronomers conduct surveys to collect many
sightlines and create large absorber catalogs that contain information about
the variety of absorption lines found in each individual sightline. These
catalogs create a statistical picture of the CGM and have proved invaluable in
our understanding of the dynamics in the CGM.

As a complement to observational surveys, hydrodynamic simulations have also
become increasingly important for studying the CGM and efforts have been made to
apply absorption line analysis to simulated data
[@Smith:2011; @Egan:2014; @Peeples:2019]. Trident[^1] is a Python package that
can extract an artificial sightline, referred to as a “LightRay” in the code,
from simulation data and then generate synthetic spectra from that sightline
[@Hummels:2017]. This provides the opportunity to explore a simulation from an
observer’s perspective, which facilitates making direct comparisons to
observational studies. In this way, Trident provides a new avenue of study for
simulators. However, a straightforward, streamlined process for replicating
observational absorber catalogs is not yet readily available.

In order to fill this void, we introduce the Python package, SALSA (Synthetic
Absorption Line Surveyor Application). SALSA is a package that generates
synthetic absorber catalogs by studying the LightRays and/or spectra generated
using Trident. SALSA provides an automated pipeline to process large numbers of
LightRays and extract absorber information into a catalog for further analysis.
Two separate methods are made available to extract absorbers. The “Spectacle
method” uses the Python package Spectacle[^2] to fit Voigt profiles to the
synthetic spectra generated by Trident (see \autoref{fig:1}) [@spectacle]. This
method provides traditional absorption line information (e.g. Doppler broadening,
equivalent width, etc.) and thus creates synthetic absorber catalogs very similar
to those made from observational studies.

The “SPICE (Simple Procedure for Iterative Cloud Extraction) method” is a novel
method that uses cell level data from the simulation to find the contiguous
groups of cells which will meaningfully contribute absorption line features to
the synthetic spectra. It does this through an iterative process that isolates
the regions along the LightRay with the highest number density values and
returns those regions with observationally detectable column densities as
individual absorbers (see \autoref{fig:1} or for more details, the documentation[^3]). 
This method provides direct access to the information contained in the simulation 
(e.g. temperature, velocity, metallicity, etc.) and, in turn, more information 
than can be provided by spectral absorption line analysis alone.

![These plots were generated using FOGGIE simulation data [@Peeples:2019]. The
top plot shows the number density profile of O VI along the length of the
LightRay. The shaded regions were found by the SPICE method and represent the
absorbers that would be extracted.  The bottom plot shows the synthetic spectra
for that same LightRay. The dashed lines represent the two absorption lines that
Spectacle fit to the spectra. \label{fig:1}](spice_spectacle_fig.png)

Each method has its own advantages and disadvantages depending on the research
goals. Spectacle extracts absorbers in a way that is much more analogous to that
of observational studies and thus can more easily be used to make “apples-to-apples”
comparisons between simulations and observations. The SPICE method, on
the other hand, retains much of the additional information provided by
simulation data, allowing for more in-depth analysis of the properties of
absorbers and how those relate to the simulated galaxy as a whole.

Once a synthetic absorber catalog is generated, analysis of the data can proceed
from an observer’s perspective. Coupling this analysis with the unprocessed
simulation data can bring powerful insights about how the CGM functions and how
observations might provide a limited view into this complex medium. Current
research efforts with the FOGGIE collaboration[^4] are leveraging SALSA to
study O VI absorbers in the CGM. Further work will assuredly provide more
discoveries and better connect the cutting-edge research done by computational
and observational astronomers studying the CGM.


[^1]: https://trident.readthedocs.io/en/latest/

[^2]: https://spectacle-py.readthedocs.io/en/latest/

[^3]: https://salsa.readthedocs.io/en/latest/

[^4]: http://foggie.science/


# Acknowledgements

This work was supported by STScI grant HST-AR-14315.001-A and NSF grants
AAG-1514700 and AAG-1908109. The authors would also like to thank the members of
the FOGGIE Collaboration and the developers of the Trident software package, Cameron
Hummels and Britton Smith, for their contributions in helping to make the SALSA 
package a reality.

# References
